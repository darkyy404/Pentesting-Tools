
import os
import re

def print_banner():
    print(r"""
                        ___   .-------.    ______
                       /   \  |  Nmap  |  /      \
                      /  .  \ | Scanner | |  ,--. |
                     /  /_\  \|_________| |  `--' |
                    /  _____  \  ______  |  |`--'| 
                   /__/     \__\ |______|  |_____| 

                       .-"      "-.
                      /            \
                     |              |
                     |,  .-.  .-.  ,|
                     | )(_o/  \o_)( |
                     |/     /\     \|
           (@_       (_     ^^     _)
      _     ) \_______\__|IIIIII|__/_________________
     (_)@8@8{}<________|-\IIIIII/-|_______________>
            )_/         \          /
           (@            `--------`
    """)

# Función para validar si la entrada es una IP o un dominio
def validar_ip_dominio(objetivo):
    ip_regex = r"^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$"
    dominio_regex = r"^([a-zA-Z0-9-]{1,63}\.)+[a-zA-Z]{2,6}$"
    return re.match(ip_regex, objetivo) or re.match(dominio_regex, objetivo)

# Función para ejecutar comandos Nmap y capturar el resultado
def ejecutar_comando_nmap(comando, descripcion):
    print(f"\nEjecutando: {descripcion}...")
    resultado = os.popen(comando).read()  # Captura el resultado del comando
    print(resultado)
    return resultado

# Funciones de escaneo reutilizando la validación
def quick_scan(target):
    if validar_ip_dominio(target):
        ejecutar_comando_nmap(f"nmap -T4 -F {target}", "Escaneo rápido de puertos")

def full_scan(target):
    if validar_ip_dominio(target):
        ejecutar_comando_nmap(f"nmap -p- {target}", "Escaneo completo de puertos")

def os_detection(target):
    if validar_ip_dominio(target):
        ejecutar_comando_nmap(f"nmap -O {target}", "Detección de sistemas operativos")

def vuln_scan(target):
    if validar_ip_dominio(target):
        ejecutar_comando_nmap(f"nmap --script vuln {target}", "Escaneo de vulnerabilidades básicas")

# Función principal del menú
def menu():
    print_banner()
    print("\n--- Menú de Escaneo Nmap ---")
    print("1. Escaneo rápido de puertos")
    print("2. Escaneo completo de puertos")
    print("3. Detección de sistemas operativos")
    print("4. Escaneo de vulnerabilidades")
    print("5. Salir")
    
    opcion = input("\nSelecciona una opción: ")
    if opcion in ['1', '2', '3', '4']:
        objetivo = input("Ingresa la dirección IP o dominio objetivo: ")
        
        if opcion == '1':
            quick_scan(objetivo)
        elif opcion == '2':
            full_scan(objetivo)
        elif opcion == '3':
            os_detection(objetivo)
        elif opcion == '4':
            vuln_scan(objetivo)
    elif opcion == '5':
        print("Saliendo del programa...")
        exit()
    else:
        print("Opción no válida. Inténtalo de nuevo.")

if __name__ == "__main__":
    while True:
        menu()
